// Refs2 : emphasizes that a variable is just a slot for the pointer, so that actually immutable classes are safe to pass to the methods, ensuring that from the other scope it is impossible to substitude a variable in your scope
class Refs2 extends EntryPoint then
    method assert(cond : Boolean): Refs2 is
        if cond.Not() then
            this.ExitCode := 1
        end
    end

    method DoSmth(a : Integer) is
        a := a.Plus(2)
    end

    this(stdin: CharInput, stdout: CharOutput, stderr: CharOutput, args: Array[Array[Integer]]) is
        var a : 1
        var b : a.Plus(1)

        this := this.assert(a.Equal(1))
        this := this.assert(b.Equal(2))

        this := this.DoSmth(a)

        this := this.assert(a.Equal(1))
        this := this.assert(b.Equal(2))

        a := b

        this := this.assert(a.Equal(2))
        this := this.assert(b.Equal(2))
        this := this.assert(a.SameRef(b))

        a := a.Plus(1)

        this := this.assert(a.Equal(3))
        this := this.assert(b.Equal(2))
    end
end
