// Refs2 : emphasizes that a variable is just a slot for the pointer, so that actually immutable classes are safe to pass to the methods, ensuring that from the other scope it is impossible to substitude a variable in your scope
class Refs2 extends EntryPoint is
    method assert(cond : Boolean) : void is
        if cond.not() then
            this.exit_code := 1
        end
    end

    method doSmth(a : Integer) : void is
        a := a.plus(2)
    end

    this(stdin: StdIn, stdout: StdOut, stderr: StdOut, args: Array[Array[Integer]]) is
        var a : Integer := 1
        var b : Integer := a.plus(1)

        this.assert(a.equal(1))
        this.assert(b.equal(2))

        this.doSmth(a)

        this.assert(a.equal(1))
        this.assert(b.equal(2))

        a := b

        this.assert(a.equal(2))
        this.assert(b.equal(2))
        this.assert(a.sameRef(b))

        a := a.plus(1)

        this.assert(a.equal(3))
        this.assert(b.equal(2))
    end
end
